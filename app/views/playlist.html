{% set title = title %}
{% extends 'layout.html' %}
{% block content %}

<div class="wrapper">
  <header class="playback-header">
    <h1>{{ title }}</h1>
    <time><span class="current-time">0:00</span> / <span class="total-time">{{ totalTime }}</span></time>
  </header>
  <section class="playlist">
    <ul class="playlist-track-list">
    {% for track in tracks %}
      <li class="playback-track">
        <div class="playback-track-artwork">
          <img src="{{ track.artwork }}" />
        </div>
        <h2 class="playback-track-title">{{ track.title }}</h2>
<!--         <div class="progress-bar">
          <div class="current-progress"></div>
          <canvas class="progress-circle" width="250" height="250"></canvas>
        </div> -->
      </li>
    {% endfor %}
    </ul>
    <div class="messages"></div>
  </section>

  {% if hasFinished %}
  <p>Sorry, this playlist has now finished. Go <a href="/">make a new one</a>.</p>
  {% endif %}
</div>

<script>
var bootstrap = [{{ tracks|raw }}];
var playlist_id = "{{ id }}";
</script>
{% endblock %}


{% block scripts %}
{% if !hasFinished %}
<script src="http://{{ socketAddress }}/socket.io/socket.io.js"></script>
<script>
$(function() {
  var socket = io.connect('http://{{ socketAddress }}');
  TWM.Playlist.start();
  socket.on('connect', function (data) {
    TWM.Playlist.API.onUserConnect(socket);
    TWM.Playlist.API.joinRoom();
  });
});
</script>
{% endif %}
{% endblock %}